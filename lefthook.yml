pre-commit:
  parallel: true
  jobs:
    - name: biome check
      glob: "*.{js,ts,jsx,tsx,json}"
      run: pnpm biome check --no-errors-on-unmatched {staged_files}

    - name: typecheck
      glob: "*.{ts,tsx}"
      run: pnpm typecheck

commit-msg:
  jobs:
    - name: conventional commits
      run: |
        MESSAGE=$(head -1 {1})
        if ! echo "$MESSAGE" | grep -qE '^(feat|fix|refactor|docs|test|chore|perf|ci)(\(.+\))?!?: .+'; then
          echo "Commit message must follow conventional commits format:"
          echo "  <type>[optional scope][!]: <description>"
          echo "  Types: feat, fix, refactor, docs, test, chore, perf, ci"
          exit 1
        fi
